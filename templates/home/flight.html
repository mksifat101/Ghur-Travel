{% extends 'base.html' %}
{% block title %} Flight Search {% endblock %}
{% load static %}
{% block content %}

<!-- ================================
    START BREADCRUMB AREA
================================= -->
<section class="breadcrumb-area bread-bg-6">
    <div class="breadcrumb-wrap">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-12">
                    <div class="search-result-content">
                        <div class="section-heading">
                            <h2 class="sec__title text-white">Flight Search Result</h2>
                        </div>
                        <div class="search-fields-container margin-top-30px">
                            <div class="contact-form-action">
                                <form action="{% url 'flight_search' %}" class="row" method="get">
                                    <div class="col-lg-3 col-sm-6 pr-0">
                                        <div class="input-box">
                                            <label class="label-text">From</label>
                                            <div class="form-group">
                                                <span class="la la-map-marker form-icon"></span>
                                                <input class="form-control" type="text" placeholder="City or airport" name="orgloc">
                                            </div>
                                        </div>
                                    </div><!-- end col-lg-3 -->
                                    <div class="col-lg-3 col-sm-6 pr-0">
                                        <div class="input-box">
                                            <label class="label-text">To</label>
                                            <div class="form-group">
                                                <span class="la la-map-marker form-icon"></span>
                                                <input class="form-control" type="text" placeholder="City or airport" name="dstloc">
                                            </div>
                                        </div>
                                    </div><!-- end col-lg-3 -->
                                    <div class="col-lg-3 col-sm-6 pr-0">
                                        <div class="input-box">
                                            <label class="label-text">Date</label>
                                            <div class="form-group">
                                                <span class="la la-calendar form-icon"></span>
                                                <input class="date-range form-control" type="date" name="dstdate">
                                            </div>
                                        </div>
                                    </div><!-- end col-lg-3 -->
                                    <!-- end col-lg-3 -->
                                    <div class="col-lg-3 pr-0">
                                        <div class="input-box">
                                            <label class="label-text">Passengers</label>
                                            <div class="form-group">
                                            <div class="dropdown dropdown-contain gty-container">
                                    <a class="dropdown-toggle dropdown-btn" href="#" role="button" data-toggle="dropdown" aria-expanded="false">
                                        <span class="adult" data-text="Adult" data-text-multi="Adults">0 Adult</span>
                                        -
                                        <span class="children" data-text="Child" data-text-multi="Children">0 Child</span>
                                    </a>
                                    <div class="dropdown-menu dropdown-menu-wrap">
                                        <div class="dropdown-item">
                                        <div
                                            class="qty-box d-flex align-items-center justify-content-between"
                                        >
                                            <label>Adults</label>
                                            <div
                                            class="qtyBtn d-flex align-items-center"
                                            >
                                            <div class="qtyDec">
                                                <i class="la la-minus"></i>
                                            </div>
                                            <input
                                                type="text"
                                                name="adult_number"
                                                value="0"
                                            />
                                            <div class="qtyInc">
                                                <i class="la la-plus"></i>
                                            </div>
                                            </div>
                                        </div>
                                        </div>
                                        <div class="dropdown-item">
                                        <div
                                            class="qty-box d-flex align-items-center justify-content-between"
                                        >
                                            <label>Children</label>
                                            <div
                                            class="qtyBtn d-flex align-items-center"
                                            >
                                            <div class="qtyDec">
                                                <i class="la la-minus"></i>
                                            </div>
                                            <input
                                                type="text"
                                                name="child_number"
                                                value="0"
                                            />
                                            <div class="qtyInc">
                                                <i class="la la-plus"></i>
                                            </div>
                                            </div>
                                        </div>
                                        </div>
                                        <div class="dropdown-item">
                                        <div
                                            class="qty-box d-flex align-items-center justify-content-between"
                                        >
                                            <label>Infants</label>
                                            <div
                                            class="qtyBtn d-flex align-items-center"
                                            >
                                            <div class="qtyDec">
                                                <i class="la la-minus"></i>
                                            </div>
                                            <input
                                                type="text"
                                                name="infants_number"
                                                value="0"
                                            />
                                            <div class="qtyInc">
                                                <i class="la la-plus"></i>
                                            </div>
                                            </div>
                                        </div>
                                        </div>
                                    </div>
                                    </div>
                                    <!-- end dropdown -->
                                </div>
                                </div>
                            </div>
                            <!-- end col-lg-3 -->
                            <div class="col-lg-3 pr-0">
                                <div class="input-box">
                                <label class="label-text">Coach</label>
                                <div class="form-group select-contain w-auto">
                                    <select class="select-contain-select" name="trclass">
                                    <option value="ECONOMY" selected>Economy</option>
                                    <option value="BUSINESS">Business</option>
                                    <!-- <option value="3">First class</option> -->
                                    </select>
                                </div>
                                </div>
                            </div>
                            <!-- end col-lg-3 -->
                            </div><!-- end contact-form-action -->
                            <div class="btn-box pt-3">
                                <button type="submit" class="theme-btn">Search Now</button>
                            </div>
                        </form>
                        </div>
                    </div><!-- end search-result-content -->
                </div><!-- end col-lg-12 -->
            </div><!-- end row -->
        </div><!-- end container -->
    </div><!-- end breadcrumb-wrap -->
    <div class="bread-svg-box">
        <svg class="bread-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 10" preserveAspectRatio="none"><polygon points="100 0 50 10 0 0 0 10 100 10"></polygon></svg>
    </div><!-- end bread-svg -->
</section><!-- end breadcrumb-area -->
<!-- ================================
    END BREADCRUMB AREA
================================= -->

<!-- ================================
    START CARD AREA
================================= -->
<section class="card-area section--padding">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="filter-wrap margin-bottom-30px">
                    <div class="filter-top d-flex align-items-center justify-content-between pb-4">
                        <div>
                            <h3 class="title font-size-24">{{count}} Flights found</h3>
                            <p class="font-size-14"><span class="mr-1 pt-1">Book with confidence:</span>No flight booking fees</p>
                        </div>
                        <!-- <div class="layout-view d-flex align-items-center">
                            <a href="flight-grid.html" data-toggle="tooltip" data-placement="top" title="Grid View"><i class="la la-th-large"></i></a>
                            <a href="flight-list.html" data-toggle="tooltip" data-placement="top" title="List View" class="active"><i class="la la-th-list"></i></a>
                        </div> -->
                    </div><!-- end filter-top -->
                </div>
            </div><!-- end col-lg-12 -->
        </div><!-- end row -->
        <div class="row">
            <div class="col-lg-4">
                <div class="sidebar mt-0">
                    <div class="sidebar-widget">
                        <h3 class="title stroke-shape">Filter by Price</h3>
                        <div class="sidebar-price-range">
                            <div class="slider-range-wrap">
                                <div class="price-slider-amount padding-bottom-20px">
                                    <label for="amount2" class="filter__label">Price:</label>
                                    <input type="text" id="amount2" class="amounts">
                                </div><!-- end price-slider-amount -->
                                <div id="slider-range2"></div><!-- end slider-range -->
                            </div><!-- end slider-range-wrap -->
                            <div class="btn-box pt-4">
                                <button class="theme-btn theme-btn-small theme-btn-transparent" type="button">Apply</button>
                            </div>
                        </div>
                    </div><!-- end sidebar-widget -->
                    
                    <div class="sidebar-widget">
                        <h3 class="title stroke-shape">Flight Stops</h3>
                        <div class="sidebar-widget-item">
                            <div class="custom-checkbox">
                                <input type="checkbox" id="flightStop1">
                                <label for="flightStop1">1 Stop</label>
                            </div>
                            <div class="custom-checkbox">
                                <input type="checkbox" id="flightStop2">
                                <label for="flightStop2">2 Stops</label>
                            </div>
                            <div class="custom-checkbox">
                                <input type="checkbox" id="flightStop3">
                                <label for="flightStop3">3 Stops</label>
                            </div>
                            <div class="custom-checkbox">
                                <input type="checkbox" id="flightStop4">
                                <label for="flightStop4">MultiStops</label>
                            </div>
                        </div>
                    </div><!-- end sidebar-widget -->
                    <div class="sidebar-widget">
                        <h3 class="title stroke-shape">Inflight Experience</h3>
                        <div class="sidebar-widget-item">
                            <div class="custom-checkbox">
                                <input type="checkbox" id="chb23">
                                <label for="chb23">Inflight Dining</label>
                            </div>
                            <div class="custom-checkbox">
                                <input type="checkbox" id="chb24">
                                <label for="chb24">Music</label>
                            </div>
                            <div class="custom-checkbox">
                                <input type="checkbox" id="chb25">
                                <label for="chb25">Sky Shopping</label>
                            </div>
                            <div class="custom-checkbox">
                                <input type="checkbox" id="chb26">
                                <label for="chb26">Wi-fi</label>
                            </div>
                            <div class="custom-checkbox">
                                <input type="checkbox" id="chb27">
                                <label for="chb27">Seats & Cabin</label>
                            </div>
                        </div>
                    </div><!-- end sidebar-widget -->
                </div><!-- end sidebar -->
            </div><!-- end col-lg-4 -->
            <div class="col-lg-8">
                <form action="{% url 'flight_booking' %}" method="get">
                {% for result in result %}
                <div class="card-item flight-card flight--card card-item-list card-item-list-2">
                    <div class="card-img">
                        <img src="{% static 'assets/images/airline-img10.png' %}" alt="flight-logo-img">
                    </div>
                    <div class="card-body">
                        <div class="card-top-title d-flex justify-content-between">
                            {% for its in result.itineraries %}
                            {% for stg in its.segments %}
                            <div>
                                <h3 class="card-title font-size-17">{{stg.departure.iataCode}}</h3>
                                <p class="card-meta font-size-14">One way flight</p>
                            </div>
                            <input type="text" name="dstlocation"bvalue="{{stg.arrival.iataCode}}" hidden>
                            <input type="text" name="dsttime" value="{{stg.departure.at}}" hidden>
                            <input type="text" name="orglocation" value="{{stg.departure.iataCode}}" hidden>
                            <input type="text" name="orgtime" value="{{stg.departure.at}}" hidden>
                            <input type="text" name="time" value="{{time}}" hidden>
                            <input type="text" name="duration" value="{{stg.duration}}" hidden>
                            <input type="text" name="adult" value="{{adult}}" hidden>
                            <input type="text" name="child" value="{{child}}" hidden>
                            <input type="text" name="trclass" value="{{trclass}}" hidden>
                            <!-- <div>
                                <h3 class="card-title font-size-17">Beijing</h3>
                                <p class="card-meta font-size-14">One way flight</p>
                            </div> -->
                            {% endfor %}
                            {% endfor %}
                            <div>
                                <div class="text-right">
                                    <span class="font-weight-regular font-size-14 d-block">avg/person</span>
                                    <h6 class="font-weight-bold color-text">{{result.price.total}}</h6>
                                    <input type="text" name="price" value="{{result.price.total}}" hidden>
                                </div>
                            </div>
                        </div><!-- end card-top-title -->
                        <div class="flight-details py-3">
                            <div class="flight-time pb-3">
                                {% for its in result.itineraries %}
                                {% for stg in its.segments %}
                                <div class="flight-time-item take-off d-flex">
                                    <div class="flex-shrink-0 mr-2">
                                        <i class="la la-plane"></i>
                                    </div>
                                    <div>
                                        <h3 class="card-title font-size-15 font-weight-medium mb-0">Take off</h3>
                                        <p class="card-meta font-size-14">{{stg.departure.at}}</p>
                                    </div>
                                </div>
                                <div class="flight-time-item landing d-flex">
                                    <div class="flex-shrink-0 mr-2">
                                        <i class="la la-plane"></i>
                                    </div>
                                    <div>
                                        <h3 class="card-title font-size-15 font-weight-medium mb-0">Landing</h3>
                                        <p class="card-meta font-size-14">{{stg.arrival.at}}</p>
                                    </div>
                                    {% endfor %}
                                    {% endfor %}
                                </div>
                            </div><!-- end flight-time -->
                            <p class="font-size-14 text-center"><span class="color-text-2 mr-1">Total Time:</span>{{result.duration}}</p>
                        </div><!-- end flight-details -->
                        <div class="btn-box text-center">
                            <button type="submit" class="theme-btn theme-btn-small w-100">Book Now</button>
                        </div>
                    </div><!-- end card-body -->
                </div><!-- end card-item -->
                {% endfor %}
            </div><!-- end col-lg-8 -->
            </form>
        </div><!-- end row -->
        <div class="row">
            <div class="col-lg-12">
                <div class="btn-box mt-3 text-center">
                    <button type="button" class="theme-btn"><i class="la la-refresh mr-1"></i>Load More</button>
                    <p class="font-size-13 pt-2">Showing 1 - 6 of 24 Flights</p>
                </div><!-- end btn-box -->
            </div><!-- end col-lg-12 -->
        </div><!-- end row -->
    </div><!-- end container -->
</section><!-- end card-area -->
<!-- ================================
    END CARD AREA
================================= -->

<div class="section-block"></div>

<!-- ================================
    START INFO AREA
================================= -->
<section class="info-area info-bg padding-top-90px padding-bottom-70px">
    <div class="container">
        <div class="row">
            <div class="col-lg-4 responsive-column">
                <a href="#" class="icon-box icon-layout-2 d-flex">
                    <div class="info-icon flex-shrink-0 bg-rgb text-color-2">
                        <i class="la la-phone"></i>
                    </div><!-- end info-icon-->
                    <div class="info-content">
                        <h4 class="info__title">Need Help? Contact us</h4>
                        <p class="info__desc">
                            Lorem ipsum dolor sit amet, consectetur adipisicing
                        </p>
                    </div><!-- end info-content -->
                </a><!-- end icon-box -->
            </div><!-- end col-lg-4 -->
            <div class="col-lg-4 responsive-column">
                <a href="#" class="icon-box icon-layout-2 d-flex">
                    <div class="info-icon flex-shrink-0 bg-rgb-2 text-color-3">
                        <i class="la la-money"></i>
                    </div><!-- end info-icon-->
                    <div class="info-content">
                        <h4 class="info__title">Payments</h4>
                        <p class="info__desc">
                            Lorem ipsum dolor sit amet, consectetur adipisicing
                        </p>
                    </div><!-- end info-content -->
                </a><!-- end icon-box -->
            </div><!-- end col-lg-4 -->
            <div class="col-lg-4 responsive-column">
                <a href="#" class="icon-box icon-layout-2 d-flex">
                    <div class="info-icon flex-shrink-0 bg-rgb-3 text-color-4">
                        <i class="la la-times"></i>
                    </div><!-- end info-icon-->
                    <div class="info-content">
                        <h4 class="info__title">Cancel Policy</h4>
                        <p class="info__desc">
                            Lorem ipsum dolor sit amet, consectetur adipisicing
                        </p>
                    </div><!-- end info-content -->
                </a><!-- end icon-box -->
            </div><!-- end col-lg-4 -->
        </div><!-- end row -->
    </div><!-- end container -->
</section><!-- end info-area -->
<!-- ================================
    END INFO AREA
================================= -->

<!-- ================================
    START CTA AREA
================================= -->
<section class="cta-area subscriber-area section-bg-2 padding-top-60px padding-bottom-60px">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-7">
                <div class="section-heading">
                    <h2 class="sec__title font-size-30 text-white">Subscribe to see Secret Deals</h2>
                </div><!-- end section-heading -->
            </div><!-- end col-lg-7 -->
            <div class="col-lg-5">
                <div class="subscriber-box">
                    <div class="contact-form-action">
                        <form action="#">
                            <div class="input-box">
                                <label class="label-text text-white">Enter email address</label>
                                <div class="form-group mb-0">
                                    <span class="la la-envelope form-icon"></span>
                                    <input class="form-control" type="email" name="email" placeholder="Email address">
                                    <button class="theme-btn theme-btn-small submit-btn" type="submit">Subscribe</button>
                                    <span class="font-size-14 pt-1 text-white-50"><i class="la la-lock mr-1"></i>Don't worry your information is safe with us.</span>
                                </div>
                            </div>
                        </form>
                    </div>
                </div><!-- end section-heading -->
            </div><!-- end col-lg-5 -->
        </div><!-- end row -->
    </div><!-- end container -->
</section><!-- end cta-area -->
<!-- ================================
    END CTA AREA
================================= -->

{% endblock %}